<!DOCTYPE html>
<html>
<head>
  <title>Upload & Predict</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>

<header>
  <h1>Upload & Predict</h1>
  <nav>
    <a href="index.html">Home</a>
    <a href="playground.html">AI Playground</a>
    <a href="ai-chat.html">AI Chat</a>
  </nav>
</header>

<div class="container">

  <div class="section">
    <h2>Upload Your File</h2>
    <p>Select a CSV or Excel file and choose a model.</p>

    <div class="card">

      <!-- File Upload -->
      <label>Select File:</label>
      <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" />

      <!-- Model Selection -->
      <label>Select Model:</label>
      <select id="modelSelect">
        <option value="linear_regression">Linear Regression</option>
        <option value="random_forest_regressor">Random Forest Regressor</option>
        <option value="logistic_regression">Logistic Regression</option>
        <option value="random_forest_classifier">Random Forest Classifier</option>
        <option value="kmeans">KMeans</option>
        <option value="dbscan">DBSCAN</option>
        <option value="automl">AutoML</option>
      </select>

      <!-- Run Prediction -->
      <button class="button" onclick="handleUpload()">Run Prediction</button>

      <!-- Output -->
      <pre id="status"></pre>
    </div>
  </div>

</div>

<script>
async function handleUpload() {
  const file = document.getElementById("fileInput").files[0];
  const model = document.getElementById("modelSelect").value;
  const status = document.getElementById("status");

  if (!file) {
    status.textContent = "Please select a file first.";
    status.style.color = "red";
    return;
  }

  const formData = new FormData();
  formData.append("file", file);
  formData.append("model", model);

  status.textContent = "Processing...";
  status.style.color = "black";

  try {
    const response = await fetch("https://ml-backend-yury.onrender.com/predict", {
      method: "POST",
      body: formData
    });

    const result = await response.json();
    status.textContent = JSON.stringify(result, null, 2);
    status.style.color = "green";

  } catch (error) {
    status.textContent = "Error: " + error;
    status.style.color = "red";
  }
}
</script>

</body>
</html>
